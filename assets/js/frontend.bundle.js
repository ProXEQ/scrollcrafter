(()=>{var k={},I=new WeakSet;function E(e,n){k[e]=n}function _(e=document,n=!1){if(!e)return;let r=[];e.hasAttribute&&e.hasAttribute("data-scrollcrafter-config")&&r.push(e),e.querySelectorAll&&e.querySelectorAll("[data-scrollcrafter-config]").forEach(t=>r.push(t)),r.forEach(t=>{var y,S;let g=I.has(t);if(!n&&g)return;if(typeof t.__sc_cleanup=="function"){try{t.__sc_cleanup()}catch(c){console.warn("[ScrollCrafter] Cleanup error:",c)}delete t.__sc_cleanup}let d=t.getAttribute("data-scrollcrafter-config");if(!d)return;let w;try{w=JSON.parse(d)}catch(c){(y=window.ScrollCrafterConfig)!=null&&y.debug&&console.warn("[ScrollCrafter] Invalid config JSON:",c,t);return}let m=w.widget;if(!(!m||typeof k[m]!="function"))try{(S=window.ScrollCrafterConfig)!=null&&S.debug&&console.log(`[ScrollCrafter] Initializing widget: "${m}"`,t);let c=k[m](t,w);typeof c=="function"&&(t.__sc_cleanup=c),I.add(t),t.dispatchEvent(new CustomEvent("scrollcrafter:init",{bubbles:!0,detail:{type:m,config:w}}))}catch(c){console.error(`[ScrollCrafter] Init error for "${m}":`,c)}})}function A(){if(typeof window=="undefined")return null;let{gsap:e}=window;if(!e)return console.error("[ScrollCrafter] GSAP core not found! Make sure gsap.min.js is loaded."),null;if(window.ScrollTrigger&&e.registerPlugin)try{e.registerPlugin(window.ScrollTrigger)}catch(n){}return e}function T(){return typeof window=="undefined"?null:window.ScrollTrigger?window.ScrollTrigger:(console.warn("[ScrollCrafter] ScrollTrigger not found! Animations may not work."),null)}function R(e,n){if(typeof e!="string")return e;if(e==="calc_scroll_width_neg"&&(e="calc(sw * -1)"),e==="calc_scroll_width"&&(e="calc(sw)"),e==="calc_100vh"&&(e="calc(vh)"),e.match(/^calc\s*\((.*)\)$/i)){let r=e.match(/^calc\s*\((.*)\)$/i)[1];return r=r.replace(/(\d)\s*(sw|cw|ch|vw|vh)\b/gi,"$1 * $2"),(t,g)=>{let d=g||n,w=window.innerWidth,m=window.innerHeight,y=d.clientWidth||0,S=d.clientHeight||0,c=d.scrollWidth-y,p=c>0?c:0,C=(w-y)/2,h=(m-S)/2,a=w-y,o={sw:p,cw:y,ch:S,vw:w,vh:m,center:C,vcenter:h,end:a},s=r;if(Object.keys(o).forEach(l=>{let f=new RegExp(`\\b${l}\\b`,"gi");s=s.replace(f,"")}),!/^[0-9\.\+\-\*\/\(\)\s]*$/.test(s))return console.warn("[ScrollCrafter] Unsafe calc expression:",r),0;let i=r;Object.keys(o).sort((l,f)=>f.length-l.length).forEach(l=>{let f=new RegExp(`\\b${l}\\b`,"gi");i=i.replace(f,o[l])});try{return new Function("return "+i)()}catch(l){return console.error("[ScrollCrafter] Calc error:",l),0}}}return e}function F(e,n){if(!e||typeof e!="object")return e;let r={...e};return Object.keys(r).forEach(t=>{let g=r[t];if(g&&typeof g=="object"&&!Array.isArray(g)){r[t]=F(g,n);return}r[t]=R(g,n)}),r}E("scroll_animation",(e,n)=>{var h,a;let r=!!((h=window.ScrollCrafterConfig)!=null&&h.debug),t=`[ScrollCrafter][${n.id||"anim"}]`,g=(o,s)=>{var i,u,l;r&&(console.group(`${t} ${o}`),console.log("Method:",(i=s.animation)==null?void 0:i.method),console.log("Vars:",(u=s.animation)==null?void 0:u.vars),console.log("Vars2:",(l=s.animation)==null?void 0:l.vars2),console.log("Target:",s.target||n.target),console.groupEnd())};r&&console.log(`${t} RAW CONFIG`,n);let d;try{d=A(),T()}catch(o){r&&console.error(`${t} GSAP missing`,o);return}let w=(o,s)=>{var O,W;let i=o.target||n.target||{},u=[];if(i.type==="wrapper"?u=[s]:i.selector?u=s.querySelectorAll(i.selector):u=[s],!u.length)return r&&console.warn(`${t} No elements found for selector:`,i.selector),null;let l=o.animation||{},f=l.method||"from",M=u[0];if(l.split)if(r&&console.log(`${t} SplitText requested: ${l.split}, SplitText available: ${typeof window.SplitText}`),window.SplitText)try{u.forEach(x=>{x._splitText&&(r&&console.log(`${t} Reverting existing SplitText`),x._splitText.revert())});let v=new SplitText(u,{type:l.split});u.forEach(x=>{x._splitText=v}),v.chars&&v.chars.length?u=v.chars:v.words&&v.words.length?u=v.words:v.lines&&v.lines.length&&(u=v.lines),r&&console.log(`${t} SplitText created, elements count: ${u.length}`),u.length&&d.set(u,{display:"inline-block"})}catch(v){console.warn(`${t} SplitText error:`,v)}else console.warn(`${t} SplitText not available! Make sure GSAP SplitText is loaded.`);let b=F({...l.vars},M),$=l.vars2?F({...l.vars2},M):null;return d.set(u,{transition:"none",translate:"none",rotate:"none",scale:"none"}),b.scrollTrigger&&(b.scrollTrigger.trigger=s,n.id&&(b.scrollTrigger.id="sc-"+n.id)),$&&$.scrollTrigger&&($.scrollTrigger.trigger=s,n.id&&($.scrollTrigger.id="sc-"+n.id)),r&&(console.log(`${t} CreateTween: method=${f}, elements=${u.length}`,u),console.log(`${t} Stagger Value:`,(W=(O=b.stagger)!=null?O:l.stagger)!=null?W:"none"),console.log(`${t} Vars:`,b),$&&console.log(`${t} Vars2 (To):`,$)),f==="fromTo"&&$?d.fromTo(u,b,$):typeof d[f]=="function"?d[f](u,b):(r&&console.warn(`${t} Unknown GSAP method:`,f),null)},m=d.matchMedia(),S=[...((a=window.ScrollCrafterConfig)==null?void 0:a.breakpoints)||[]].sort((o,s)=>o.value-s.value),c=0,p=[];S.forEach(o=>{let s=c+1,i=o.value;c=i;let u=s===1?`(max-width: ${i}px)`:`(min-width: ${s}px) and (max-width: ${i}px)`;p.push({slug:o.key,query:u})}),p.push({slug:"_default_desktop",query:`(min-width: ${c+1}px)`});let C=[];return p.forEach(o=>{m.add(o.query,()=>{let s=n.animation;if(o.slug!=="_default_desktop"&&n.media&&n.media[o.slug]?(s=n.media[o.slug],g(`Active: ${o.slug} (Override)`,{...n,animation:s})):g(`Active: ${o.slug} (Global)`,n),s){let i=w({...n,animation:s},e);if(i&&C.push(i),(window.ScrollCrafterForcePreview===n.id||window.parent&&window.parent.ScrollCrafterForcePreview===n.id||e.getAttribute("data-sc-preview")==="yes")&&i)if(r&&console.log(`${t} Manual preview detected, force playing animation`),i.scrollTrigger){let l=i.scrollTrigger;l.pin||l.vars&&l.vars.scrub?(r&&console.log(`${t} Pin/Scrub detected, animating progress`),d.fromTo(l,{progress:0},{progress:1,duration:1.5,ease:"power1.inOut"})):(l.disable(),i.restart(!0))}else i.restart(!0)}})}),()=>{r&&console.log(`${t} Cleaning up...`),m.revert(),C.forEach(o=>{o.scrollTrigger&&o.scrollTrigger.kill(!0),o.kill()})}});function V(e,n){if(typeof e!="string")return e;if(e==="calc_scroll_width_neg"&&(e="calc(sw * -1)"),e==="calc_scroll_width"&&(e="calc(sw)"),e==="calc_100vh"&&(e="calc(vh)"),e.match(/^calc\s*\((.*)\)$/i)){let r=e.match(/^calc\s*\((.*)\)$/i)[1];return r=r.replace(/(\d)\s*(sw|cw|ch|vw|vh)\b/gi,"$1 * $2"),(t,g)=>{let d=g||n,w=window.innerWidth,m=window.innerHeight,y=d.clientWidth||0,S=d.clientHeight||0,c=d.scrollWidth-y,p=c>0?c:0,C=(w-y)/2,h=w-y,a=(m-S)/2,o={sw:p,cw:y,ch:S,vw:w,vh:m,center:C,vcenter:a,end:h},s=r;if(Object.keys(o).forEach(l=>{let f=new RegExp(`\\b${l}\\b`,"gi");s=s.replace(f,"")}),!/^[0-9\.\+\-\*\/\(\)\s]*$/.test(s))return console.warn("[ScrollCrafter] Unsafe characters in calc expression:",r),0;let i=r;Object.keys(o).sort((l,f)=>f.length-l.length).forEach(l=>{let f=new RegExp(`\\b${l}\\b`,"gi");i=i.replace(f,o[l])});try{return new Function("return "+i)()}catch(l){return console.error("[ScrollCrafter] Calc error:",l),0}}}return e}function P(e,n){if(!e||typeof e!="object")return e;let r={...e};return Object.keys(r).forEach(t=>{let g=r[t];if(g&&typeof g=="object"&&!Array.isArray(g)){r[t]=P(g,n);return}r[t]=V(g,n)}),r}function q(e,n,r,t,g,d){let w=e,m=n.target||r.target||{},y=[w];if(m.selector&&m.type!=="wrapper"){let h=w.querySelectorAll(m.selector);h.length&&(y=Array.from(h))}let S={...n.timelineVars||{}};S.defaults&&(S.defaults=P(S.defaults,w)),S.scrollTrigger||(S.scrollTrigger={});let c=S.scrollTrigger;c.trigger||(c.trigger=w),c.pin===!0&&(c.pin=w),c.pin&&d.set(c.pin,{transition:"none"}),typeof c.invalidateOnRefresh=="undefined"&&(c.invalidateOnRefresh=!0),typeof c.anticipatePin=="undefined"&&(c.anticipatePin=.5),r.id&&!c.id&&(c.id=`sc-${r.id}`);let p=d.timeline(S);return(n.steps||[]).forEach((h,a)=>{let o=h.method||"to",s=h.position;if(o==="addLabel"){let f=h.vars;typeof f=="string"&&p.addLabel(f,s);return}if(o==="call")return;let i=y;if(h.selector){let f=w.querySelectorAll(h.selector);if(!f.length){t&&console.warn(`${g} Step ${a+1}: selector "${h.selector}" not found`);return}i=Array.from(f)}let u=P(h.vars||{},w),l=h.vars2?P(h.vars2,w):null;if(h.split&&window.SplitText)try{let f=new SplitText(i,{type:h.split});f.chars&&f.chars.length?i=f.chars:f.words&&f.words.length?i=f.words:f.lines&&f.lines.length&&(i=f.lines),i.length&&d.set(i,{display:"inline-block"})}catch(f){t&&console.warn(`${g} SplitText error:`,f)}t&&console.log(`${g} Step ${a+1}: method=${o}, targets=${i.length}`,i);try{o==="fromTo"&&l?p.fromTo(i,u,l,s):typeof p[o]=="function"&&p[o](i,u,s)}catch(f){t&&console.error(`${g} Error step ${a+1}`,f)}}),p}E("scroll_timeline",(e,n)=>{var C,h;let r=!!((C=window.ScrollCrafterConfig)!=null&&C.debug),t=`[ScrollCrafter][timeline:${n.id||"tl"}]`,g=(a,o)=>{r&&(console.group(`${t} ${a}`),console.log("Details:",o),console.groupEnd())},d;try{d=A(),T()}catch(a){r&&console.error(`${t} GSAP missing`,a);return}let w=d.matchMedia(),y=[...((h=window.ScrollCrafterConfig)==null?void 0:h.breakpoints)||[]].sort((a,o)=>a.value-o.value),S=0,c=[];y.forEach(a=>{let o=S+1,s=a.value;S=s;let i=o===1?`(max-width: ${s}px)`:`(min-width: ${o}px) and (max-width: ${s}px)`;c.push({slug:a.key,query:i})}),c.push({slug:"_default_desktop",query:`(min-width: ${S+1}px)`});let p=[];return c.forEach(a=>{w.add(a.query,()=>{let o=n,s=!1;if(a.slug!=="_default_desktop"&&n.media&&n.media[a.slug]&&n.media[a.slug]&&(o=n.media[a.slug],s=!0),o&&o.steps&&o.steps.length>0){let i;if(s?(g(`Active: ${a.slug} (Override)`,o),i=q(e,o,n,r,t+`[${a.slug}]`,d)):(g(`Active: ${a.slug} (Global)`,o),i=q(e,o,n,r,t,d)),i&&p.push(i),(window.ScrollCrafterForcePreview===n.id||window.parent&&window.parent.ScrollCrafterForcePreview===n.id||e.getAttribute("data-sc-preview")==="yes")&&i)if(r&&console.log(`${t} Manual preview detected, force playing timeline`),i.scrollTrigger){let l=i.scrollTrigger;l.pin||l.vars&&l.vars.scrub?(r&&console.log(`${t} Pin/Scrub detected, animating progress`),d.fromTo(l,{progress:0},{progress:1,duration:1.5,ease:"power1.inOut"})):(l.disable(),i.restart(!0))}else i.restart(!0)}})}),()=>{r&&console.log(`${t} Cleaning up...`),w.revert(),p.forEach(a=>{a.scrollTrigger&&a.scrollTrigger.kill(!0),a.kill()})}});function j(){_(document)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",j):j();window.addEventListener("elementor/popup/show",e=>{_(e.target);let n=T();n&&n.refresh()});var G=()=>{let e=0,n=50,r=()=>{var t,g,d;if(!window.elementorFrontend||!window.elementorFrontend.hooks){e++,e<n?(e%10===0&&((t=window.ScrollCrafterConfig)!=null&&t.debug)&&console.log(`[ScrollCrafter] Still waiting for elementorFrontend hooks (attempt ${e})...`),setTimeout(r,100)):console.warn("[ScrollCrafter] Elementor hooks not found after 5s. Animations might not initialize.");return}(g=window.ScrollCrafterConfig)!=null&&g.debug&&console.log("[ScrollCrafter] Elementor hooks found. Registering..."),elementorFrontend.hooks.addAction("frontend/element_ready/global",w=>{var y,S,c;let m=w[0];if(m){if(elementorFrontend.isEditMode()){let p=m.getAttribute("data-id");p&&B(p);let C=o=>{try{if(window.ScrollCrafterForcePreview===o||window.parent&&window.parent.ScrollCrafterForcePreview===o||window.top&&window.top.ScrollCrafterForcePreview===o||sessionStorage.getItem("sc_force_preview")===o)return!0}catch(s){}return!1},h=!!((y=window.ScrollCrafterConfig)!=null&&y.enableEditorAnimations),a=m.getAttribute("data-sc-preview")==="yes"||C(p);if(a&&((S=window.ScrollCrafterConfig)!=null&&S.debug)&&console.log("[ScrollCrafter] Preview init:",{widgetId:p,allowLive:h,isManualPreview:a}),!h&&!a)return;a&&(console.log("[ScrollCrafter] Preview active, cleaning up flags"),setTimeout(()=>{window.ScrollCrafterForcePreview===p&&(window.ScrollCrafterForcePreview=!1),window.parent&&window.parent.ScrollCrafterForcePreview===p&&(window.parent.ScrollCrafterForcePreview=!1),window.top&&window.top.ScrollCrafterForcePreview===p&&(window.top.ScrollCrafterForcePreview=!1),sessionStorage.removeItem("sc_force_preview")},100))}(c=window.ScrollCrafterConfig)!=null&&c.debug&&console.log("[ScrollCrafter] Triggering initWidgetsInScope for node"),_(m,elementorFrontend.isEditMode()),elementorFrontend.isEditMode()&&setTimeout(()=>{var C;let p=T();p&&((C=window.ScrollCrafterConfig)!=null&&C.debug&&console.log("[ScrollCrafter] Editor Refresh ScrollTrigger"),p.refresh())},200)}}),(d=window.ScrollCrafterConfig)!=null&&d.debug&&console.log("[ScrollCrafter] Elementor hooks registered successfully")};r()};G();window.addEventListener("elementor/frontend/init",G);function B(e){var n;try{let r=T();if(!r)return;let t="sc-"+e,g=r.getById(t);g&&((n=window.ScrollCrafterConfig)!=null&&n.debug&&console.log(`[ScrollCrafter] Killing trigger: ${t}`),g.kill(!0))}catch(r){console.warn("[ScrollCrafter] Error killing trigger:",r)}}})();
