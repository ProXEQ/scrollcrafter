{
  "version": 3,
  "sources": ["../../src/fs/fs.ts"],
  "sourcesContent": ["import fs, { writeFileSync } from \"node:fs\";\nimport { readFile } from \"node:fs/promises\";\nimport path from \"node:path\";\nimport type { Args } from \"../types.js\";\n\n/**\n * Ensures that a folder exists at the specified path.\n *\n * @param {string | undefined} folderPath - The path of the folder to ensure existence for.\n * @return {string} - The path of the folder, or '.' if folderPath is undefined.\n */\nfunction ensureFolderExists(folderPath: string | undefined): string {\n\tif (folderPath === undefined) {\n\t\treturn \".\";\n\t}\n\ttry {\n\t\t// Check if the folder exists\n\t\tfs.accessSync(\n\t\t\tpath.resolve(folderPath),\n\t\t\tfs.constants.R_OK | fs.constants.W_OK,\n\t\t);\n\t} catch (error) {\n\t\tif ((error as NodeJS.ErrnoException).code === \"ENOENT\") {\n\t\t\t// The Folder does not exist, so create it\n\t\t\tfs.mkdirSync(folderPath, { recursive: true });\n\t\t\tconsole.log(`Folder created: ${folderPath}`);\n\t\t\treturn folderPath;\n\t\t}\n\t}\n\treturn folderPath;\n}\n\n/**\n * Gets the charset of the .pot file\n *\n * @param charset the charset of the .pot file\n * @return the charset of the .pot file\n */\nexport function getCharset(charset: string | undefined): BufferEncoding {\n\tif (!charset) {\n\t\treturn \"latin1\";\n\t}\n\t// we need to check if the charset is valid otherwise we return latin1 that is a common alias for ISO-8859-1 and the default charset for pot files\n\tswitch (charset.toLowerCase()) {\n\t\tcase \"utf-8\":\n\t\tcase \"utf8\":\n\t\t\treturn \"utf-8\";\n\t\tdefault:\n\t\t\treturn \"latin1\";\n\t}\n}\n\nexport function getEncodingCharset(charset: string | undefined): string {\n\tif (!charset) {\n\t\treturn \"iso-8859-1\";\n\t}\n\t// we need to check if the charset is valid otherwise we return utf-8 that is a common alias for ISO-8859-1 and the default charset for pot files\n\tswitch (charset.toLowerCase()) {\n\t\tcase \"utf-8\":\n\t\tcase \"utf8\":\n\t\t\treturn \"utf-8\";\n\t\tdefault:\n\t\t\treturn \"iso-8859-1\";\n\t}\n}\n\n/**\n * The output path for the pot file.\n * @param args - the command line arguments\n */\nfunction getOutputFilePath(args: Args): string {\n\tconst { out, headers, options } = args.paths;\n\tlet i18nFolder = out ?? headers?.domainPath ?? \"languages\";\n\n\t// Remove leading and trailing slashes\n\ti18nFolder = i18nFolder.replace(/^\\/+|\\/+$/g, \"\");\n\n\tconst extension = options?.json ? \"json\" : \"pot\";\n\n\treturn path.join(process.cwd(), i18nFolder, `${args.slug}.${extension}`);\n}\n\n/**\n * Writes the .pot file to disk\n *\n * @param fileContent the content of the .pot file\n * @param args the command line arguments passed to the program\n */\nexport function writeFile(fileContent: string, args: Args): void {\n\tconst dest = getOutputFilePath(args);\n\n\tif (ensureFolderExists(path.dirname(dest))) {\n\t\t// get the encoding charset\n\t\tconst encodingCharset = getCharset(args.options?.charset);\n\t\tconsole.log(`\\nPot File created at ${dest}`);\n\n\t\t// write the file\n\t\tconst potBuffer = Buffer.from(fileContent);\n\t\twriteFileSync(dest, potBuffer.toString(encodingCharset), {\n\t\t\tencoding: encodingCharset,\n\t\t});\n\t} else {\n\t\tconsole.log(`Folder ${dest} does not exist and cannot be created`);\n\t}\n}\n\n/**\n * The async version of fs.readFile method\n * @param path the path of the file to read\n * @return the content of the file as a string\n */\nexport async function readFileAsync(path: string): Promise<string> {\n\treturn readFile(path, \"utf-8\");\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAkC;AAClC,sBAAyB;AACzB,uBAAiB;AASjB,SAAS,mBAAmB,YAAwC;AACnE,MAAI,eAAe,QAAW;AAC7B,WAAO;AAAA,EACR;AACA,MAAI;AAEH,mBAAAA,QAAG;AAAA,MACF,iBAAAC,QAAK,QAAQ,UAAU;AAAA,MACvB,eAAAD,QAAG,UAAU,OAAO,eAAAA,QAAG,UAAU;AAAA,IAClC;AAAA,EACD,SAAS,OAAO;AACf,QAAK,MAAgC,SAAS,UAAU;AAEvD,qBAAAA,QAAG,UAAU,YAAY,EAAE,WAAW,KAAK,CAAC;AAC5C,cAAQ,IAAI,mBAAmB,UAAU,EAAE;AAC3C,aAAO;AAAA,IACR;AAAA,EACD;AACA,SAAO;AACR;AAQO,SAAS,WAAW,SAA6C;AACvE,MAAI,CAAC,SAAS;AACb,WAAO;AAAA,EACR;AAEA,UAAQ,QAAQ,YAAY,GAAG;AAAA,IAC9B,KAAK;AAAA,IACL,KAAK;AACJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAEO,SAAS,mBAAmB,SAAqC;AACvE,MAAI,CAAC,SAAS;AACb,WAAO;AAAA,EACR;AAEA,UAAQ,QAAQ,YAAY,GAAG;AAAA,IAC9B,KAAK;AAAA,IACL,KAAK;AACJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAMA,SAAS,kBAAkB,MAAoB;AAC9C,QAAM,EAAE,KAAK,SAAS,QAAQ,IAAI,KAAK;AACvC,MAAI,aAAa,OAAO,SAAS,cAAc;AAG/C,eAAa,WAAW,QAAQ,cAAc,EAAE;AAEhD,QAAM,YAAY,SAAS,OAAO,SAAS;AAE3C,SAAO,iBAAAC,QAAK,KAAK,QAAQ,IAAI,GAAG,YAAY,GAAG,KAAK,IAAI,IAAI,SAAS,EAAE;AACxE;AAQO,SAAS,UAAU,aAAqB,MAAkB;AAChE,QAAM,OAAO,kBAAkB,IAAI;AAEnC,MAAI,mBAAmB,iBAAAA,QAAK,QAAQ,IAAI,CAAC,GAAG;AAE3C,UAAM,kBAAkB,WAAW,KAAK,SAAS,OAAO;AACxD,YAAQ,IAAI;AAAA,sBAAyB,IAAI,EAAE;AAG3C,UAAM,YAAY,OAAO,KAAK,WAAW;AACzC,sCAAc,MAAM,UAAU,SAAS,eAAe,GAAG;AAAA,MACxD,UAAU;AAAA,IACX,CAAC;AAAA,EACF,OAAO;AACN,YAAQ,IAAI,UAAU,IAAI,uCAAuC;AAAA,EAClE;AACD;AAOA,eAAsB,cAAcA,OAA+B;AAClE,aAAO,0BAASA,OAAM,OAAO;AAC9B;",
  "names": ["fs", "path"]
}
